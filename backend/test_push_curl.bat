@echo off
echo ============================================================
echo JSON 推送 API 测试 (使用 curl)
echo ============================================================
echo.

echo === 测试 1: 推送单条在售房源 ===
curl -X POST "http://localhost:8000/api/push" ^
  -H "Content-Type: application/json" ^
  -d "[{\"数据源\":\"test_api\",\"房源ID\":\"API_TEST_001\",\"状态\":\"在售\",\"小区名\":\"测试小区API\",\"室\":3,\"厅\":2,\"卫\":2,\"朝向\":\"南\",\"楼层\":\"15/28\",\"面积\":120.5,\"挂牌价\":500.0,\"上架时间\":\"2024-01-15T10:00:00\"}]"
echo.
echo.

echo === 测试 2: 推送多条房源 ===
curl -X POST "http://localhost:8000/api/push" ^
  -H "Content-Type: application/json" ^
  -d "[{\"数据源\":\"test_api\",\"房源ID\":\"API_TEST_002\",\"状态\":\"在售\",\"小区名\":\"测试小区API\",\"室\":2,\"厅\":1,\"卫\":1,\"朝向\":\"东南\",\"楼层\":\"10/20\",\"面积\":85.0,\"挂牌价\":350.0,\"上架时间\":\"2024-02-01T10:00:00\"},{\"数据源\":\"test_api\",\"房源ID\":\"API_TEST_003\",\"状态\":\"成交\",\"小区名\":\"测试小区API\",\"室\":3,\"厅\":2,\"卫\":2,\"朝向\":\"南北\",\"楼层\":\"高楼层/25\",\"面积\":110.0,\"成交价\":480.0,\"成交时间\":\"2024-02-15T14:30:00\"}]"
echo.
echo.

echo === 测试 3: 推送包含验证错误的数据 ===
curl -X POST "http://localhost:8000/api/push" ^
  -H "Content-Type: application/json" ^
  -d "[{\"数据源\":\"test_api\",\"房源ID\":\"API_TEST_004\",\"状态\":\"在售\",\"小区名\":\"测试小区API\",\"室\":2,\"厅\":1,\"卫\":1,\"朝向\":\"南\",\"楼层\":\"5/10\",\"面积\":90.0,\"挂牌价\":400.0,\"上架时间\":\"2024-03-01T10:00:00\"},{\"数据源\":\"test_api\",\"房源ID\":\"API_TEST_005\",\"状态\":\"在售\",\"小区名\":\"测试小区API\",\"室\":3,\"厅\":2,\"卫\":2,\"朝向\":\"东\",\"楼层\":\"8/15\",\"面积\":100.0,\"上架时间\":\"2024-03-01T10:00:00\"}]"
echo.
echo.

echo === 测试 4: 推送空数组（应该失败）===
curl -X POST "http://localhost:8000/api/push" ^
  -H "Content-Type: application/json" ^
  -d "[]"
echo.
echo.

echo ============================================================
echo 测试完成
echo ============================================================
